<head>
	<script src="jquery-1.11.1.min.js"></script>
	<script src="underscore.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<style>

		body {
		  font: 10px sans-serif;
		}

		.axis path,
		.axis line {
		  fill: none;
		  stroke: #000;
		  shape-rendering: crispEdges;
		}

		.x.axis path {
		  display: none;
		}

		.line {
		  fill: none;
		  stroke: steelblue;
		  stroke-width: 1.5px;
		}

	</style>
	
</head>
<body>
	<h1>Election Hashtag Graphs</h1>
	<div id="graph"></div>

	<script>
		//populate top 20 hashtags
		$.get('/hashtaggraph/20', function(data){
			console.log(data);
			graphdata = _.groupBy(_.map(data, function(d){
				return {hashtag: d._id.hashtag, ts: d._id.hour, val: d.value};
			}), 'hashtag');	

			var parseDate = d3.time.format("%Y-%m-%dT%H:%M:%S.000Z").parse;

			graphdata.forEach(function(d) {
    			d.date = parseDate(d.ts);
  			});

			console.log(graphdata);	

		var margin = {top: 20, right: 80, bottom: 30, left: 50},
		    width = 960 - margin.left - margin.right,
		    height = 500 - margin.top - margin.bottom;

		

		var x = d3.time.scale()
		    .range([0, width]);

		var y = d3.scale.linear()
		    .range([height, 0]);

		var color = d3.scale.category10();

		var xAxis = d3.svg.axis()
		    .scale(x)
		    .orient("bottom");

		var yAxis = d3.svg.axis()
		    .scale(y)
		    .orient("left");

		var line = d3.svg.line()
		    .interpolate("basis")
		    .x(function(d) { return x(d.date); })
		    .y(function(d) { return y(d.temperature); });

		var svg = d3.select("body").append("svg")
		    .attr("width", width + margin.left + margin.right)
		    .attr("height", height + margin.top + margin.bottom)
		  	.append("g")
		    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");



		});
	</script>
</body>